# Django 5.2 ì½”ë”© ê·œì¹™

## í…œí”Œë¦¿ ê°œë°œ ê·œì¹™

### Atomic Design í•„ìˆ˜ ì ìš©

- **ğŸ“‹ ìƒì„¸ ê·œì¹™**: `atomic-design.mdc` íŒŒì¼ ì°¸ì¡°
- ëª¨ë“  í…œí”Œë¦¿ì€ components ì•±ì˜ atoms/molecules/organisms ì‚¬ìš©
- ì§ì ‘ HTML ì‘ì„± ê¸ˆì§€, ë°˜ë“œì‹œ include ì‚¬ìš©

### í…œí”Œë¦¿ êµ¬ì¡° ì˜ˆì‹œ

```html
<!-- ì˜¬ë°”ë¥¸ ë°©ë²• -->
{% include "atoms/badge.html" with text="SSR" variant="badge-primary" %} {%
include "molecules/search_bar.html" with placeholder="ê²€ìƒ‰..." %} {% include
"organisms/navbar.html" %}

<!-- ì˜ëª»ëœ ë°©ë²• -->
<div class="badge badge-primary">SSR</div>
```

## Django ì•± êµ¬ì¡°

- **ì•± ë¶„ë¦¬**: ê¸°ëŠ¥ë³„ë¡œ ë…ë¦½ì ì¸ ì•±ìœ¼ë¡œ ë¶„ë¦¬
- **apps/ ë””ë ‰í† ë¦¬**: ëª¨ë“  Django ì•±ì„ apps/ í•˜ìœ„ì— ë°°ì¹˜
- **ì„¤ì • ë¶„ë¦¬**: settings/ ë””ë ‰í† ë¦¬ë¡œ í™˜ê²½ë³„ ì„¤ì • ë¶„ë¦¬

## ëª¨ë¸ ì„¤ê³„

```python
# models.py ì˜ˆì‹œ
from django.db import models
from django.core.validators import MinValueValidator, MaxValueValidator

class Character(models.Model):
    """ìš°ë§ˆë¬´ìŠ¤ë©” ìºë¦­í„° ëª¨ë¸"""
    id = models.IntegerField(primary_key=True)
    name = models.CharField(max_length=100, unique=True)
    rarity = models.CharField(max_length=20, choices=RARITY_CHOICES)

    class Meta:
        db_table = 'character_data'
        verbose_name = 'ìºë¦­í„°'
        verbose_name_plural = 'ìºë¦­í„°ë“¤'

    def __str__(self) -> str:
        return f"{self.name} ({self.rarity})"
```

## Composite Primary Key í™œìš© (Django 5.2)

```python
class SupportCard(models.Model):
    """ì„œí¬íŠ¸ ì¹´ë“œ ëª¨ë¸ - Composite PK ì‚¬ìš©"""
    card_id = models.IntegerField()
    rarity = models.CharField(max_length=10)

    class Meta:
        constraints = [
            models.UniqueConstraint(
                fields=['card_id', 'rarity'],
                name='unique_card_rarity'
            )
        ]
        primary_key = models.UniqueConstraint(
            fields=['card_id', 'rarity'],
            name='pk_card_rarity'
        )
```

## ViewSet íŒ¨í„´ (DRF)

```python
# views.py ì˜ˆì‹œ
from rest_framework import viewsets, status
from rest_framework.decorators import action
from rest_framework.response import Response
from django.core.cache import cache

class CharacterViewSet(viewsets.ReadOnlyModelViewSet):
    """ìºë¦­í„° API ViewSet"""
    queryset = Character.objects.all()
    serializer_class = CharacterSerializer

    @action(detail=True, methods=['post'])
    def simulate(self, request, pk=None):
        """ìºë¦­í„° ìœ¡ì„± ì‹œë®¬ë ˆì´ì…˜"""
        character = self.get_object()
        # ì‹œë®¬ë ˆì´ì…˜ ë¡œì§
        return Response({'result': 'success'})
```

## Channels Consumer íŒ¨í„´

```python
# consumers.py ì˜ˆì‹œ
import json
from channels.generic.websocket import AsyncWebsocketConsumer
from channels.db import database_sync_to_async

class SimulationConsumer(AsyncWebsocketConsumer):
    async def connect(self):
        """WebSocket ì—°ê²°"""
        self.session_id = self.scope['url_route']['kwargs']['session_id']
        self.room_group_name = f'simulation_{self.session_id}'

        await self.channel_layer.group_add(
            self.room_group_name,
            self.channel_name
        )
        await self.accept()

    async def disconnect(self, close_code):
        """WebSocket ì—°ê²° í•´ì œ"""
        await self.channel_layer.group_discard(
            self.room_group_name,
            self.channel_name
        )

    async def receive(self, text_data):
        """ë©”ì‹œì§€ ìˆ˜ì‹ """
        data = json.loads(text_data)
        # ì²˜ë¦¬ ë¡œì§
        await self.channel_layer.group_send(
            self.room_group_name,
            {
                'type': 'simulation_update',
                'data': data
            }
        )
```

## URL íŒ¨í„´

```python
# urls.py ì˜ˆì‹œ
from django.urls import path, include
from rest_framework.routers import DefaultRouter
from apps.api.views import CharacterViewSet

router = DefaultRouter()
router.register(r'characters', CharacterViewSet)

urlpatterns = [
    path('api/', include(router.urls)),
    path('ws/', include('apps.realtime.urls')),
]
```

## ì„¤ì • íŒŒì¼ êµ¬ì¡°

```python
# settings/base.py
from pathlib import Path
from decouple import config

BASE_DIR = Path(__file__).resolve().parent.parent.parent

# ë³´ì•ˆ ì„¤ì •
SECRET_KEY = config('SECRET_KEY')
DEBUG = config('DEBUG', default=False, cast=bool)
ALLOWED_HOSTS = config('ALLOWED_HOSTS', default='localhost').split(',')

# ë°ì´í„°ë² ì´ìŠ¤
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': config('DB_NAME'),
        'USER': config('DB_USER'),
        'PASSWORD': config('DB_PASSWORD'),
        'HOST': config('DB_HOST'),
        'PORT': config('DB_PORT'),
        'OPTIONS': {
            'charset': 'utf8mb4',
        },
    }
}

# Channels ì„¤ì •
ASGI_APPLICATION = 'project.asgi.application'
CHANNEL_LAYERS = {
    'default': {
        'BACKEND': 'channels_redis.core.RedisChannelLayer',
        'CONFIG': {
            'hosts': [('redis', 6379)],
        },
    },
}

# ìºì‹œ ì„¤ì •
CACHES = {
    'default': {
        'BACKEND': 'django_redis.cache.RedisCache',
        'LOCATION': 'redis://redis:6379/1',
        'OPTIONS': {
            'CLIENT_CLASS': 'django_redis.client.DefaultClient',
        }
    }
}
```

## ë§ˆì´ê·¸ë ˆì´ì…˜ ê·œì¹™

- **ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼**: ìë™ ìƒì„± í›„ ê²€í† 
- **ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜**: ë³µì¡í•œ ë°ì´í„° ë³€ê²½ ì‹œ ë³„ë„ ë§ˆì´ê·¸ë ˆì´ì…˜
- **ë¡¤ë°± ê³„íš**: ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤íŒ¨ ì‹œ ë¡¤ë°± ë°©ë²• ì¤€ë¹„

## í…ŒìŠ¤íŠ¸ íŒ¨í„´

```python
# tests.py ì˜ˆì‹œ
from django.test import TestCase
from django.urls import reverse
from rest_framework.test import APITestCase
from channels.testing import WebsocketCommunicator

class CharacterAPITest(APITestCase):
    def setUp(self):
        self.character = Character.objects.create(
            name="í…ŒìŠ¤íŠ¸ ìºë¦­í„°",
            rarity="SSR"
        )

    def test_character_list(self):
        """ìºë¦­í„° ëª©ë¡ API í…ŒìŠ¤íŠ¸"""
        url = reverse('character-list')
        response = self.client.get(url)
        self.assertEqual(response.status_code, 200)
        self.assertEqual(len(response.data), 1)
```

## ì„±ëŠ¥ ìµœì í™”

- **select_related()**: ForeignKey ê´€ê³„ ìµœì í™”
- **prefetch_related()**: ManyToMany ê´€ê³„ ìµœì í™”
- **only()/defer()**: í•„ìš”í•œ í•„ë“œë§Œ ì¡°íšŒ
- **bulk_create()**: ëŒ€ëŸ‰ ë°ì´í„° ì‚½ì… ì‹œ ì‚¬ìš©

---

description: "Django 5.2 íŠ¹í™” ì½”ë”© ê·œì¹™ ë° ëª¨ë²” ì‚¬ë¡€"
type: Auto Attached
globs: ["apps/**", "project/**", "**/models.py", "**/views.py", "**/urls.py"]
autoApply: true

---
